<div [@routerTransition]>
    <app-page-header [icon]="'fa-bar-chart-o'" [heading]="'Client Details'"></app-page-header>
    <div class="row">
        <div class="col-md-6">
            <input type="text" class="form-control" placeholder="search..." [(ngModel)]="currSearchTxt" />
            <div class="table-responsive">
                <table class="table table-hover table-striped">
                    <!-- <thead>
                        <tr>
                            <th>name</th>
                        </tr>
                    </thead> -->
                    <tbody>
                        <tr *ngFor="let cl of clientList |  filter : 'name' : currSearchTxt ; let i = index">
                            <td class="table-data-padding" (click)="readOnlyEnable(cl)" (dblclick)="editClient(cl)">
                                {{cl.name}}</td>
                            <td class="table-data-padding"><span (click)="deleteConfirmation(cl)"
                                    class="fa fa-trash pull-right"></span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class=" col-md-6">
            <form name="form" id="clientForm" (ngSubmit)="f.form.valid&&clientCreate(f)" #f="ngForm" novalidate>
                <div class="row">
                    <div class="col-md-8">
                        <div class="form-group">
                            <label>Client Name<span class="required">*</span></label>
                            <input class="form-control" [readonly]="readOnlyForm" [(ngModel)]="clientModel.name" name="code"
                                [ngClass]="{'is-invalid': f.submitted && code.invalid}" #code="ngModel" required>
                            <div class="invalid-feedback">
                                client name is mandatory
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="form-group">
                            <label>Address<span class="required">*</span></label>
                            <input class="form-control" [readonly]="readOnlyForm" [(ngModel)]="clientModel.address" name="decription"
                                [ngClass]="{'is-invalid': f.submitted && description.invalid}" #description="ngModel"
                                required>
                            <div class="invalid-feedback">
                                address is mandatory
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="table-responsive">
                        <table class="table table-hover table-striped">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>E-mail</th>
                                    <th>Phone</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let cc of clientModel.clientContacts">
                                    <td>
                                        <input class="form-control" [readonly]="readOnlyForm" [(ngModel)]="cc.fullname" name="fullname"
                                            [ngClass]="{'is-invalid': f.submitted && fullname.invalid}"
                                            #fullname="ngModel" required>
                                    </td>
                                    <td>
                                        <input class="form-control" [readonly]="readOnlyForm" [(ngModel)]="cc.email" name="email"
                                            [ngClass]="{'is-invalid': f.submitted && email.invalid}" #email="ngModel"
                                            required>
                                    </td>
                                    <td>
                                        <input class="form-control" [readonly]="readOnlyForm" [(ngModel)]="cc.phone" name="phone"
                                            [ngClass]="{'is-invalid': f.submitted && phone.invalid}" #phone="ngModel"
                                            required>
                                    </td>
                                    <td>
                                        <span>+</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="row text-center">
                        <div class="col-md-8">
                            <span *ngIf="formButtonsToggler;else toggleButtons">
                                <button type="submit" id="add" class="btn btn-secondary ml-3">Add</button>
                            </span>
                            <ng-template #toggleButtons>
                                <span *ngIf="editButtonToggler;else toggleEdit">
                                    <button type="button" id="update" class="btn btn-secondary ml-2"
                                        (click)="editableForm()">Edit</button>
                                </span>
                                <ng-template #toggleEdit>
                                    <button type="button" id="update" class="btn btn-secondary ml-2"
                                        (click)="updateClient(f)">Update</button>
                                </ng-template>
                            </ng-template>
                            <button type="button" id="cancel" (click)="cancelForm(f)"
                                class="btn btn-secondary ml-3">Cancel</button>
                        </div>
                    </div>
            </form>
        </div>
    </div>
</div>